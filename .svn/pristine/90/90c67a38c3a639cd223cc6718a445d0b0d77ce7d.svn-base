function [bw_single_new] = extract_single_segment(bw_single)
% extract single edge segment based on segment length
% cut off shorter branch and remain the longer one
[rj, cj, re, ce] = findendsjunctions(bw_single); 
    [row, col] = find(bw_single == 1);
    [N,neigh_num] = find_neighbor_info(bw_single,row,col);
    

% if ~isempty(rj) || ~isempty(cj)
%     error('junction points still exist, check it!')
% end

end